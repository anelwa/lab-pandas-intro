{
  "hash": "93cdceefe331d7e756d6798e33253e2a",
  "result": {
    "markdown": "---\ntitle: Import Unclean Excel Data \nlang: en\nsubtitle: Pandas Introduction\nauthor: Jan Kirenz\nexecute:\n  eval: true\n  echo: true\nhighlight-style: github\nformat:\n  revealjs: \n    toc: true\n    toc-depth: 1\n    embed-resources: false\n    theme: [dark, ../custom.scss]  \n    incremental: true\n    transition: slide\n    background-transition: fade\n    transition-speed: slow\n    code-copy: true\n    code-line-numbers: true\n    smaller: false\n    scrollable: true\n    slide-number: c\n    preview-links: auto\n    chalkboard: \n      buttons: false\n   #logo: images/logo.png\n    footer: Jan Kirenz\n---\n\n# Import unclean Excel data\n\n\n## Data from GENESIS-Online\n\n![](/images/genesis.png)\n\n- [GENESIS-Online](https://www-genesis.destatis.de/genesis/online) is the main database of the Federal Statistical Office \n\n\n## GENESIS-Online\n\n- Contains deeply structured results of official statistics. \n\n- You can use the database without registration. \n\n- All data are available free of charge.\n\n- We use [this dataset](https://www-genesis.destatis.de/datenbank/beta/statistic/12211/table/12211-9014) as an example \n\n# Setup\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\n```\n:::\n\n\n# Data\n\n## First data import\n\n[Data source](https://www-genesis.destatis.de/datenbank/beta/statistic/12211/table/12211-9014)\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndf_unclean = pd.read_excel('12211-9014_de.xlsx', sheet_name='12211-9014')\n```\n:::\n\n\n. . .\n\n- Take a look at the data\n\n::: {.cell output-location='slide' execution_count=3}\n``` {.python .cell-code}\ndf_unclean\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Bev√∂lkerung (ab 15 Jahren): Bundesl√§nder, Jahre (bis 2019),\\nGeschlecht, Allgemeine Schulausbildung</th>\n      <th>Unnamed: 1</th>\n      <th>Unnamed: 2</th>\n      <th>Unnamed: 3</th>\n      <th>Unnamed: 4</th>\n      <th>Unnamed: 5</th>\n      <th>Unnamed: 6</th>\n      <th>Unnamed: 7</th>\n      <th>Unnamed: 8</th>\n      <th>Unnamed: 9</th>\n      <th>Unnamed: 10</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Mikrozensus</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Bev√∂lkerung (ab 15 Jahren) (1000)</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Jahr\\nGeschlecht\\nBundesl√§nder</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Allgemeine Schulausbildung</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Noch in schulischer Ausbildung</td>\n      <td>Haupt- (Volks-)schulabschluss</td>\n      <td>Abschluss der polytechnischen Oberschule</td>\n      <td>Realschule oder gleichwertiger Abschluss</td>\n      <td>Fachhochschul- oder Hochschulreife</td>\n      <td>Ohne Angabe zur Art des Abschlusses</td>\n      <td>Ohne allgemeinen Schulabschluss</td>\n      <td>Insgesamt</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>168</td>\n      <td>1512</td>\n      <td>37</td>\n      <td>1023</td>\n      <td>1723</td>\n      <td>11</td>\n      <td>191</td>\n      <td>4674</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>67</th>\n      <td>Zensus 2011.</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>68</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>69</th>\n      <td>Ab 2017:</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>70</th>\n      <td>Ohne Bev√∂lkerung in Gemeinschaftsunterk√ºnften.</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>71</th>\n      <td>¬© Statistisches Bundesamt (Destatis), 2023 | S...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>72 rows √ó 11 columns</p>\n</div>\n```\n:::\n:::\n\n\n## Inspect footer\n\n::: {.cell output-location='fragment' execution_count=4}\n``` {.python .cell-code}\ndf_unclean.tail(25)\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Bev√∂lkerung (ab 15 Jahren): Bundesl√§nder, Jahre (bis 2019),\\nGeschlecht, Allgemeine Schulausbildung</th>\n      <th>Unnamed: 1</th>\n      <th>Unnamed: 2</th>\n      <th>Unnamed: 3</th>\n      <th>Unnamed: 4</th>\n      <th>Unnamed: 5</th>\n      <th>Unnamed: 6</th>\n      <th>Unnamed: 7</th>\n      <th>Unnamed: 8</th>\n      <th>Unnamed: 9</th>\n      <th>Unnamed: 10</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>47</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Saarland</td>\n      <td>26</td>\n      <td>337</td>\n      <td>/</td>\n      <td>185</td>\n      <td>264</td>\n      <td>/</td>\n      <td>35</td>\n      <td>853</td>\n    </tr>\n    <tr>\n      <th>48</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Sachsen</td>\n      <td>96</td>\n      <td>589</td>\n      <td>1090</td>\n      <td>658</td>\n      <td>968</td>\n      <td>/</td>\n      <td>67</td>\n      <td>3470</td>\n    </tr>\n    <tr>\n      <th>49</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Sachsen-Anhalt</td>\n      <td>53</td>\n      <td>273</td>\n      <td>760</td>\n      <td>316</td>\n      <td>427</td>\n      <td>5</td>\n      <td>50</td>\n      <td>1892</td>\n    </tr>\n    <tr>\n      <th>50</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Schleswig-Holstein</td>\n      <td>93</td>\n      <td>741</td>\n      <td>21</td>\n      <td>736</td>\n      <td>772</td>\n      <td>8</td>\n      <td>86</td>\n      <td>2471</td>\n    </tr>\n    <tr>\n      <th>51</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Th√ºringen</td>\n      <td>52</td>\n      <td>283</td>\n      <td>723</td>\n      <td>282</td>\n      <td>463</td>\n      <td>/</td>\n      <td>28</td>\n      <td>1833</td>\n    </tr>\n    <tr>\n      <th>52</th>\n      <td>______________</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>53</th>\n      <td>Ohne allgemeinen Schulabschluss:</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>Einschlie√ülich Personen mit Abschluss nach h√∂c...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>55</th>\n      <td>Jahren Schulbesuch.</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>56</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>57</th>\n      <td>Allgemeine Schulausbildung \"Insgesamt\":</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>58</th>\n      <td>Einschlie√ülich Personen, die keine Angaben zur</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>59</th>\n      <td>allgemeinen Schulausbildung gemacht haben.</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>60</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>61</th>\n      <td>Ab 2013:</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>62</th>\n      <td>Hochrechnung anhand der Bev√∂lkerungsfortschrei...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>63</th>\n      <td>Basis des Zensus 2011.</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>64</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>65</th>\n      <td>Ab 2016:</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>66</th>\n      <td>Aktualisierte Auswahlgrundlage der Stichprobe ...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>67</th>\n      <td>Zensus 2011.</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>68</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>69</th>\n      <td>Ab 2017:</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>70</th>\n      <td>Ohne Bev√∂lkerung in Gemeinschaftsunterk√ºnften.</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>71</th>\n      <td>¬© Statistisches Bundesamt (Destatis), 2023 | S...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Adjusted data import\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\ndf = pd.read_excel('12211-9014_de.xlsx', \n  sheet_name='12211-9014', \n  skiprows=[0,1,2,3], \n  skipfooter=20, \n  na_values='/', \n  thousands='.', \n  decimal=','\n  )\n```\n:::\n\n\n## View data\n\n::: {.cell output-location='fragment' execution_count=6}\n``` {.python .cell-code}\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>Unnamed: 1</th>\n      <th>Unnamed: 2</th>\n      <th>Noch in schulischer Ausbildung</th>\n      <th>Haupt- (Volks-)schulabschluss</th>\n      <th>Abschluss der polytechnischen Oberschule</th>\n      <th>Realschule oder gleichwertiger Abschluss</th>\n      <th>Fachhochschul- oder Hochschulreife</th>\n      <th>Ohne Angabe zur Art des Abschlusses</th>\n      <th>Ohne allgemeinen Schulabschluss</th>\n      <th>Insgesamt</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2019.0</td>\n      <td>m√§nnlich</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>168</td>\n      <td>1512</td>\n      <td>37.0</td>\n      <td>1023</td>\n      <td>1723</td>\n      <td>11.0</td>\n      <td>191</td>\n      <td>4674</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Bayern</td>\n      <td>175</td>\n      <td>2142</td>\n      <td>49.0</td>\n      <td>1129</td>\n      <td>1828</td>\n      <td>16.0</td>\n      <td>153</td>\n      <td>5507</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Berlin</td>\n      <td>55</td>\n      <td>205</td>\n      <td>130.0</td>\n      <td>284</td>\n      <td>765</td>\n      <td>NaN</td>\n      <td>72</td>\n      <td>1511</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Brandenburg</td>\n      <td>35</td>\n      <td>118</td>\n      <td>349.0</td>\n      <td>193</td>\n      <td>325</td>\n      <td>NaN</td>\n      <td>31</td>\n      <td>1052</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Bremen</td>\n      <td>11</td>\n      <td>74</td>\n      <td>NaN</td>\n      <td>67</td>\n      <td>115</td>\n      <td>NaN</td>\n      <td>20</td>\n      <td>290</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell output-location='fragment' execution_count=7}\n``` {.python .cell-code}\ndf.tail()\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>Unnamed: 1</th>\n      <th>Unnamed: 2</th>\n      <th>Noch in schulischer Ausbildung</th>\n      <th>Haupt- (Volks-)schulabschluss</th>\n      <th>Abschluss der polytechnischen Oberschule</th>\n      <th>Realschule oder gleichwertiger Abschluss</th>\n      <th>Fachhochschul- oder Hochschulreife</th>\n      <th>Ohne Angabe zur Art des Abschlusses</th>\n      <th>Ohne allgemeinen Schulabschluss</th>\n      <th>Insgesamt</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>43</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Saarland</td>\n      <td>26</td>\n      <td>337</td>\n      <td>NaN</td>\n      <td>185</td>\n      <td>264</td>\n      <td>NaN</td>\n      <td>35</td>\n      <td>853</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Sachsen</td>\n      <td>96</td>\n      <td>589</td>\n      <td>1090.0</td>\n      <td>658</td>\n      <td>968</td>\n      <td>NaN</td>\n      <td>67</td>\n      <td>3470</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Sachsen-Anhalt</td>\n      <td>53</td>\n      <td>273</td>\n      <td>760.0</td>\n      <td>316</td>\n      <td>427</td>\n      <td>5.0</td>\n      <td>50</td>\n      <td>1892</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Schleswig-Holstein</td>\n      <td>93</td>\n      <td>741</td>\n      <td>21.0</td>\n      <td>736</td>\n      <td>772</td>\n      <td>8.0</td>\n      <td>86</td>\n      <td>2471</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Th√ºringen</td>\n      <td>52</td>\n      <td>283</td>\n      <td>723.0</td>\n      <td>282</td>\n      <td>463</td>\n      <td>NaN</td>\n      <td>28</td>\n      <td>1833</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Rename columns\n\n::: {.cell output-location='fragment' execution_count=8}\n``` {.python .cell-code}\ndf = df.rename(columns={\n  'Unnamed: 0': 'Jahr',\n  'Unnamed: 1': 'Geschlecht',\n  'Unnamed: 2': 'Bundesland' }\n  )\n\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Jahr</th>\n      <th>Geschlecht</th>\n      <th>Bundesland</th>\n      <th>Noch in schulischer Ausbildung</th>\n      <th>Haupt- (Volks-)schulabschluss</th>\n      <th>Abschluss der polytechnischen Oberschule</th>\n      <th>Realschule oder gleichwertiger Abschluss</th>\n      <th>Fachhochschul- oder Hochschulreife</th>\n      <th>Ohne Angabe zur Art des Abschlusses</th>\n      <th>Ohne allgemeinen Schulabschluss</th>\n      <th>Insgesamt</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2019.0</td>\n      <td>m√§nnlich</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>168</td>\n      <td>1512</td>\n      <td>37.0</td>\n      <td>1023</td>\n      <td>1723</td>\n      <td>11.0</td>\n      <td>191</td>\n      <td>4674</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Bayern</td>\n      <td>175</td>\n      <td>2142</td>\n      <td>49.0</td>\n      <td>1129</td>\n      <td>1828</td>\n      <td>16.0</td>\n      <td>153</td>\n      <td>5507</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Berlin</td>\n      <td>55</td>\n      <td>205</td>\n      <td>130.0</td>\n      <td>284</td>\n      <td>765</td>\n      <td>NaN</td>\n      <td>72</td>\n      <td>1511</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Brandenburg</td>\n      <td>35</td>\n      <td>118</td>\n      <td>349.0</td>\n      <td>193</td>\n      <td>325</td>\n      <td>NaN</td>\n      <td>31</td>\n      <td>1052</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Bremen</td>\n      <td>11</td>\n      <td>74</td>\n      <td>NaN</td>\n      <td>67</td>\n      <td>115</td>\n      <td>NaN</td>\n      <td>20</td>\n      <td>290</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Fill up columns\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\ndf['Jahr'] = 2019\n```\n:::\n\n\n. . .\n\n::: {.cell output-location='fragment' execution_count=10}\n``` {.python .cell-code}\ndf['Geschlecht'] = df['Geschlecht'].fillna(method='ffill')\n\ndf.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Jahr</th>\n      <th>Geschlecht</th>\n      <th>Bundesland</th>\n      <th>Noch in schulischer Ausbildung</th>\n      <th>Haupt- (Volks-)schulabschluss</th>\n      <th>Abschluss der polytechnischen Oberschule</th>\n      <th>Realschule oder gleichwertiger Abschluss</th>\n      <th>Fachhochschul- oder Hochschulreife</th>\n      <th>Ohne Angabe zur Art des Abschlusses</th>\n      <th>Ohne allgemeinen Schulabschluss</th>\n      <th>Insgesamt</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>168</td>\n      <td>1512</td>\n      <td>37.0</td>\n      <td>1023</td>\n      <td>1723</td>\n      <td>11.0</td>\n      <td>191</td>\n      <td>4674</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Bayern</td>\n      <td>175</td>\n      <td>2142</td>\n      <td>49.0</td>\n      <td>1129</td>\n      <td>1828</td>\n      <td>16.0</td>\n      <td>153</td>\n      <td>5507</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Berlin</td>\n      <td>55</td>\n      <td>205</td>\n      <td>130.0</td>\n      <td>284</td>\n      <td>765</td>\n      <td>NaN</td>\n      <td>72</td>\n      <td>1511</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Brandenburg</td>\n      <td>35</td>\n      <td>118</td>\n      <td>349.0</td>\n      <td>193</td>\n      <td>325</td>\n      <td>NaN</td>\n      <td>31</td>\n      <td>1052</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Bremen</td>\n      <td>11</td>\n      <td>74</td>\n      <td>NaN</td>\n      <td>67</td>\n      <td>115</td>\n      <td>NaN</td>\n      <td>20</td>\n      <td>290</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Data format\n\n::: {.cell output-location='fragment' execution_count=11}\n``` {.python .cell-code}\ndf.info()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 48 entries, 0 to 47\nData columns (total 11 columns):\n #   Column                                    Non-Null Count  Dtype  \n---  ------                                    --------------  -----  \n 0   Jahr                                      48 non-null     int64  \n 1   Geschlecht                                48 non-null     object \n 2   Bundesland                                48 non-null     object \n 3   Noch in schulischer Ausbildung            48 non-null     int64  \n 4   Haupt- (Volks-)schulabschluss             48 non-null     int64  \n 5   Abschluss der polytechnischen Oberschule  42 non-null     float64\n 6   Realschule oder gleichwertiger Abschluss  48 non-null     int64  \n 7   Fachhochschul- oder Hochschulreife        48 non-null     int64  \n 8   Ohne Angabe zur Art des Abschlusses       16 non-null     float64\n 9   Ohne allgemeinen Schulabschluss           48 non-null     int64  \n 10  Insgesamt                                 48 non-null     int64  \ndtypes: float64(2), int64(7), object(2)\nmemory usage: 4.3+ KB\n```\n:::\n:::\n\n\n## Convert categorical data\n\n::: {.cell output-location='fragment' execution_count=12}\n``` {.python .cell-code}\nLIST_CAT = df.columns[1:3].tolist()\nLIST_CAT\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```\n['Geschlecht', 'Bundesland']\n```\n:::\n:::\n\n\n. . .\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\nfor i in LIST_CAT:\n  df[i] = df[i].astype('category')\n```\n:::\n\n\n## Convert numerical data\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\nLIST_INT = df.columns[3:].tolist()\nLIST_INT\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\n['Noch in schulischer Ausbildung',\n 'Haupt- (Volks-)schulabschluss',\n 'Abschluss der polytechnischen Oberschule',\n 'Realschule oder gleichwertiger Abschluss',\n 'Fachhochschul- oder Hochschulreife',\n 'Ohne Angabe zur Art des Abschlusses',\n 'Ohne allgemeinen Schulabschluss',\n 'Insgesamt']\n```\n:::\n:::\n\n\n. . .\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\nfor i in LIST_INT:\n  df[i] = df[i].astype('Int64')\n```\n:::\n\n\n## Take a look at the data\n\n::: {.cell output-location='fragment' execution_count=16}\n``` {.python .cell-code}\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Jahr</th>\n      <th>Geschlecht</th>\n      <th>Bundesland</th>\n      <th>Noch in schulischer Ausbildung</th>\n      <th>Haupt- (Volks-)schulabschluss</th>\n      <th>Abschluss der polytechnischen Oberschule</th>\n      <th>Realschule oder gleichwertiger Abschluss</th>\n      <th>Fachhochschul- oder Hochschulreife</th>\n      <th>Ohne Angabe zur Art des Abschlusses</th>\n      <th>Ohne allgemeinen Schulabschluss</th>\n      <th>Insgesamt</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>168</td>\n      <td>1512</td>\n      <td>37</td>\n      <td>1023</td>\n      <td>1723</td>\n      <td>11</td>\n      <td>191</td>\n      <td>4674</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Bayern</td>\n      <td>175</td>\n      <td>2142</td>\n      <td>49</td>\n      <td>1129</td>\n      <td>1828</td>\n      <td>16</td>\n      <td>153</td>\n      <td>5507</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Berlin</td>\n      <td>55</td>\n      <td>205</td>\n      <td>130</td>\n      <td>284</td>\n      <td>765</td>\n      <td>&lt;NA&gt;</td>\n      <td>72</td>\n      <td>1511</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Brandenburg</td>\n      <td>35</td>\n      <td>118</td>\n      <td>349</td>\n      <td>193</td>\n      <td>325</td>\n      <td>&lt;NA&gt;</td>\n      <td>31</td>\n      <td>1052</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Bremen</td>\n      <td>11</td>\n      <td>74</td>\n      <td>&lt;NA&gt;</td>\n      <td>67</td>\n      <td>115</td>\n      <td>&lt;NA&gt;</td>\n      <td>20</td>\n      <td>290</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Hamburg</td>\n      <td>32</td>\n      <td>149</td>\n      <td>6</td>\n      <td>153</td>\n      <td>361</td>\n      <td>5</td>\n      <td>49</td>\n      <td>763</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Hessen</td>\n      <td>103</td>\n      <td>722</td>\n      <td>24</td>\n      <td>621</td>\n      <td>1029</td>\n      <td>&lt;NA&gt;</td>\n      <td>118</td>\n      <td>2623</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Mecklenburg-Vorpommern</td>\n      <td>19</td>\n      <td>93</td>\n      <td>248</td>\n      <td>123</td>\n      <td>172</td>\n      <td>&lt;NA&gt;</td>\n      <td>21</td>\n      <td>677</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Niedersachsen</td>\n      <td>120</td>\n      <td>1022</td>\n      <td>35</td>\n      <td>949</td>\n      <td>1073</td>\n      <td>7</td>\n      <td>126</td>\n      <td>3338</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Nordrhein-Westfalen</td>\n      <td>311</td>\n      <td>2389</td>\n      <td>42</td>\n      <td>1515</td>\n      <td>2752</td>\n      <td>12</td>\n      <td>405</td>\n      <td>7430</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Rheinland-Pfalz</td>\n      <td>61</td>\n      <td>626</td>\n      <td>11</td>\n      <td>374</td>\n      <td>569</td>\n      <td>&lt;NA&gt;</td>\n      <td>68</td>\n      <td>1713</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Saarland</td>\n      <td>13</td>\n      <td>166</td>\n      <td>&lt;NA&gt;</td>\n      <td>85</td>\n      <td>136</td>\n      <td>&lt;NA&gt;</td>\n      <td>17</td>\n      <td>420</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Sachsen</td>\n      <td>47</td>\n      <td>257</td>\n      <td>528</td>\n      <td>334</td>\n      <td>499</td>\n      <td>&lt;NA&gt;</td>\n      <td>37</td>\n      <td>1703</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Sachsen-Anhalt</td>\n      <td>28</td>\n      <td>126</td>\n      <td>364</td>\n      <td>163</td>\n      <td>214</td>\n      <td>&lt;NA&gt;</td>\n      <td>26</td>\n      <td>928</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Schleswig-Holstein</td>\n      <td>46</td>\n      <td>373</td>\n      <td>9</td>\n      <td>326</td>\n      <td>394</td>\n      <td>&lt;NA&gt;</td>\n      <td>45</td>\n      <td>1205</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>2019</td>\n      <td>m√§nnlich</td>\n      <td>Th√ºringen</td>\n      <td>26</td>\n      <td>130</td>\n      <td>352</td>\n      <td>150</td>\n      <td>232</td>\n      <td>&lt;NA&gt;</td>\n      <td>16</td>\n      <td>907</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>171</td>\n      <td>1431</td>\n      <td>41</td>\n      <td>1356</td>\n      <td>1531</td>\n      <td>7</td>\n      <td>205</td>\n      <td>4757</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Bayern</td>\n      <td>166</td>\n      <td>2070</td>\n      <td>60</td>\n      <td>1545</td>\n      <td>1614</td>\n      <td>10</td>\n      <td>157</td>\n      <td>5638</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Berlin</td>\n      <td>48</td>\n      <td>210</td>\n      <td>151</td>\n      <td>323</td>\n      <td>778</td>\n      <td>&lt;NA&gt;</td>\n      <td>76</td>\n      <td>1587</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Brandenburg</td>\n      <td>35</td>\n      <td>139</td>\n      <td>380</td>\n      <td>185</td>\n      <td>328</td>\n      <td>&lt;NA&gt;</td>\n      <td>25</td>\n      <td>1092</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Bremen</td>\n      <td>11</td>\n      <td>70</td>\n      <td>&lt;NA&gt;</td>\n      <td>83</td>\n      <td>109</td>\n      <td>&lt;NA&gt;</td>\n      <td>20</td>\n      <td>295</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Hamburg</td>\n      <td>27</td>\n      <td>154</td>\n      <td>6</td>\n      <td>192</td>\n      <td>362</td>\n      <td>&lt;NA&gt;</td>\n      <td>49</td>\n      <td>804</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Hessen</td>\n      <td>105</td>\n      <td>716</td>\n      <td>25</td>\n      <td>794</td>\n      <td>941</td>\n      <td>&lt;NA&gt;</td>\n      <td>128</td>\n      <td>2714</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Mecklenburg-Vorpommern</td>\n      <td>19</td>\n      <td>93</td>\n      <td>275</td>\n      <td>123</td>\n      <td>170</td>\n      <td>&lt;NA&gt;</td>\n      <td>19</td>\n      <td>700</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Niedersachsen</td>\n      <td>125</td>\n      <td>1019</td>\n      <td>43</td>\n      <td>1109</td>\n      <td>986</td>\n      <td>&lt;NA&gt;</td>\n      <td>137</td>\n      <td>3428</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Nordrhein-Westfalen</td>\n      <td>318</td>\n      <td>2413</td>\n      <td>56</td>\n      <td>1839</td>\n      <td>2704</td>\n      <td>5</td>\n      <td>453</td>\n      <td>7791</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Rheinland-Pfalz</td>\n      <td>66</td>\n      <td>609</td>\n      <td>13</td>\n      <td>477</td>\n      <td>527</td>\n      <td>&lt;NA&gt;</td>\n      <td>67</td>\n      <td>1763</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Saarland</td>\n      <td>13</td>\n      <td>171</td>\n      <td>&lt;NA&gt;</td>\n      <td>100</td>\n      <td>128</td>\n      <td>&lt;NA&gt;</td>\n      <td>18</td>\n      <td>434</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Sachsen</td>\n      <td>49</td>\n      <td>333</td>\n      <td>562</td>\n      <td>324</td>\n      <td>468</td>\n      <td>&lt;NA&gt;</td>\n      <td>30</td>\n      <td>1767</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Sachsen-Anhalt</td>\n      <td>25</td>\n      <td>147</td>\n      <td>395</td>\n      <td>153</td>\n      <td>214</td>\n      <td>&lt;NA&gt;</td>\n      <td>24</td>\n      <td>964</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Schleswig-Holstein</td>\n      <td>48</td>\n      <td>367</td>\n      <td>11</td>\n      <td>409</td>\n      <td>379</td>\n      <td>&lt;NA&gt;</td>\n      <td>41</td>\n      <td>1267</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>2019</td>\n      <td>weiblich</td>\n      <td>Th√ºringen</td>\n      <td>26</td>\n      <td>153</td>\n      <td>371</td>\n      <td>132</td>\n      <td>231</td>\n      <td>&lt;NA&gt;</td>\n      <td>13</td>\n      <td>927</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>339</td>\n      <td>2943</td>\n      <td>79</td>\n      <td>2379</td>\n      <td>3254</td>\n      <td>17</td>\n      <td>395</td>\n      <td>9431</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Bayern</td>\n      <td>342</td>\n      <td>4212</td>\n      <td>109</td>\n      <td>2674</td>\n      <td>3442</td>\n      <td>26</td>\n      <td>310</td>\n      <td>11146</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Berlin</td>\n      <td>103</td>\n      <td>415</td>\n      <td>281</td>\n      <td>607</td>\n      <td>1543</td>\n      <td>&lt;NA&gt;</td>\n      <td>147</td>\n      <td>3098</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Brandenburg</td>\n      <td>70</td>\n      <td>258</td>\n      <td>728</td>\n      <td>378</td>\n      <td>653</td>\n      <td>&lt;NA&gt;</td>\n      <td>55</td>\n      <td>2144</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Bremen</td>\n      <td>21</td>\n      <td>145</td>\n      <td>&lt;NA&gt;</td>\n      <td>150</td>\n      <td>224</td>\n      <td>&lt;NA&gt;</td>\n      <td>40</td>\n      <td>585</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Hamburg</td>\n      <td>58</td>\n      <td>302</td>\n      <td>12</td>\n      <td>345</td>\n      <td>724</td>\n      <td>9</td>\n      <td>98</td>\n      <td>1567</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Hessen</td>\n      <td>208</td>\n      <td>1438</td>\n      <td>50</td>\n      <td>1415</td>\n      <td>1969</td>\n      <td>6</td>\n      <td>247</td>\n      <td>5337</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Mecklenburg-Vorpommern</td>\n      <td>38</td>\n      <td>186</td>\n      <td>523</td>\n      <td>246</td>\n      <td>342</td>\n      <td>&lt;NA&gt;</td>\n      <td>41</td>\n      <td>1377</td>\n    </tr>\n    <tr>\n      <th>40</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Niedersachsen</td>\n      <td>245</td>\n      <td>2041</td>\n      <td>78</td>\n      <td>2058</td>\n      <td>2059</td>\n      <td>11</td>\n      <td>263</td>\n      <td>6766</td>\n    </tr>\n    <tr>\n      <th>41</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Nordrhein-Westfalen</td>\n      <td>629</td>\n      <td>4802</td>\n      <td>98</td>\n      <td>3354</td>\n      <td>5456</td>\n      <td>17</td>\n      <td>858</td>\n      <td>15221</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Rheinland-Pfalz</td>\n      <td>127</td>\n      <td>1235</td>\n      <td>24</td>\n      <td>851</td>\n      <td>1097</td>\n      <td>&lt;NA&gt;</td>\n      <td>135</td>\n      <td>3476</td>\n    </tr>\n    <tr>\n      <th>43</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Saarland</td>\n      <td>26</td>\n      <td>337</td>\n      <td>&lt;NA&gt;</td>\n      <td>185</td>\n      <td>264</td>\n      <td>&lt;NA&gt;</td>\n      <td>35</td>\n      <td>853</td>\n    </tr>\n    <tr>\n      <th>44</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Sachsen</td>\n      <td>96</td>\n      <td>589</td>\n      <td>1090</td>\n      <td>658</td>\n      <td>968</td>\n      <td>&lt;NA&gt;</td>\n      <td>67</td>\n      <td>3470</td>\n    </tr>\n    <tr>\n      <th>45</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Sachsen-Anhalt</td>\n      <td>53</td>\n      <td>273</td>\n      <td>760</td>\n      <td>316</td>\n      <td>427</td>\n      <td>5</td>\n      <td>50</td>\n      <td>1892</td>\n    </tr>\n    <tr>\n      <th>46</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Schleswig-Holstein</td>\n      <td>93</td>\n      <td>741</td>\n      <td>21</td>\n      <td>736</td>\n      <td>772</td>\n      <td>8</td>\n      <td>86</td>\n      <td>2471</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Th√ºringen</td>\n      <td>52</td>\n      <td>283</td>\n      <td>723</td>\n      <td>282</td>\n      <td>463</td>\n      <td>&lt;NA&gt;</td>\n      <td>28</td>\n      <td>1833</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n# Create new dataframe with subgroub\n\n## Create new dataframe\n\n- Let's assume we only want to keep the total number and don't need to differentiate between sex\n\n. . .\n\n::: {.cell output-location='fragment' execution_count=17}\n``` {.python .cell-code}\ndf_total = df[df['Geschlecht'] == 'Insgesamt']\ndf_total.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Jahr</th>\n      <th>Geschlecht</th>\n      <th>Bundesland</th>\n      <th>Noch in schulischer Ausbildung</th>\n      <th>Haupt- (Volks-)schulabschluss</th>\n      <th>Abschluss der polytechnischen Oberschule</th>\n      <th>Realschule oder gleichwertiger Abschluss</th>\n      <th>Fachhochschul- oder Hochschulreife</th>\n      <th>Ohne Angabe zur Art des Abschlusses</th>\n      <th>Ohne allgemeinen Schulabschluss</th>\n      <th>Insgesamt</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>32</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Baden-W√ºrttemberg</td>\n      <td>339</td>\n      <td>2943</td>\n      <td>79</td>\n      <td>2379</td>\n      <td>3254</td>\n      <td>17</td>\n      <td>395</td>\n      <td>9431</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Bayern</td>\n      <td>342</td>\n      <td>4212</td>\n      <td>109</td>\n      <td>2674</td>\n      <td>3442</td>\n      <td>26</td>\n      <td>310</td>\n      <td>11146</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Berlin</td>\n      <td>103</td>\n      <td>415</td>\n      <td>281</td>\n      <td>607</td>\n      <td>1543</td>\n      <td>&lt;NA&gt;</td>\n      <td>147</td>\n      <td>3098</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Brandenburg</td>\n      <td>70</td>\n      <td>258</td>\n      <td>728</td>\n      <td>378</td>\n      <td>653</td>\n      <td>&lt;NA&gt;</td>\n      <td>55</td>\n      <td>2144</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>2019</td>\n      <td>Insgesamt</td>\n      <td>Bremen</td>\n      <td>21</td>\n      <td>145</td>\n      <td>&lt;NA&gt;</td>\n      <td>150</td>\n      <td>224</td>\n      <td>&lt;NA&gt;</td>\n      <td>40</td>\n      <td>585</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Save new dataframe\n\n- We can drop the variable \"Geschlecht\"\n\n. . .\n\n::: {.cell execution_count=18}\n``` {.python .cell-code}\ndf_total = df_total.drop(columns=['Geschlecht'])\n```\n:::\n\n\n- Save data\n\n. . .\n\n::: {.cell execution_count=19}\n``` {.python .cell-code}\ndf_total.to_excel('12211-9014_de_clean.xlsx', index=False)\n```\n:::\n\n\n# What's next? {background-image=\"../images/logo.png\" background-opacity=\"0.5\"}\n\n**Congratulations! You have completed this tutorial** üëç\n\n\n**Next, you may want to go back to the [lab's website](https://kirenz.github.io/lab-pandas-intro/)**\n\n",
    "supporting": [
      "pandas-read-excel_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}